(function newTab(){'use strict';init();function init(){getLocation();getImage();startTime()};function getLocation(){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(showPosition)}else{console.log('location is not supported')}}
function showPosition(position){let lat=position.coords.latitude;let long=position.coords.longitude;getWeather(lat,long)}
function getWeather(lat,long){const pepper='&appid=cf6f3902316f9fa78adcc4f336e2728a';const latlong=`lat=${lat}&lon=${long}`;const units='&units=metric';const url=`http://api.openweathermap.org/data/2.5/weather?${latlong}${units}${pepper}`;const cityId=document.getElementById('city');const tempId=document.getElementById('temp');const iconId=document.getElementById('weatherIcon');fetch(url).then(function(response){if(!response.ok){throw Error(response.statusText)}
return response.json()}).then(function(responseAsJson){let data=responseAsJson;const date=new Date();const sunrise=new Date(data.sys.sunrise*1000);const sunset=new Date(data.sys.sunset*1000);if(date.getHours()>=sunrise.getHours()&&date.getHours()<sunset.getHours()){var weatherIconID=`wi wi-owm-day-${data.weather[0].id}`}
else{var weatherIconID=`wi wi-owm-night-${data.weather[0].id}`}
const locationIcon='<i class="fas fa-map-marker-alt"></i>';const temperature=(data.main.temp).toFixed(0);tempId.innerHTML=` | ${temperature}&#x2103;`;iconId.setAttribute('class',weatherIconID);cityId.innerHTML=`${data.name}`}).catch(function(error){console.log('Looks like there was a problem: \n',error)})}
function getImage(){const bgImage=document.getElementById('bg');let locations;$.getJSON('js/locations.json',function(data,status,xhr){if(xhr.status>=200&&xhr.status<400){locations=data.locations
const objLength=locations.length;const item=Math.floor((Math.random()*objLength));const imageId=locations[item].id;bgImage.style.backgroundImage=locations[item].image;let locationName=locations[item].place;let location=locations[item].location;let fact=locations[item].fact;let link=locations[item].link;let owner=locations[item].owner;let url=locations[item].url;let locationIcon='<i class="fas fa-map-marker-alt"></i>';document.getElementById('locationName').innerHTML=`${locationName}`;document.getElementById('locationUrl').setAttribute('href',link);document.getElementById('location').innerHTML=`${locationIcon} ${location}`;document.getElementById('fact').innerHTML=fact;document.getElementById('owner').innerHTML=owner;document.getElementById('taker').setAttribute('href',url);const reloadImage=setTimeout(getImage,60000)}else{console.log(`error : status => ${status}`)}})};function startTime(){const clock=document.getElementById('clock');const greetElement=document.getElementById('greet');const today=new Date();const h=today.getHours();let m=today.getMinutes();let s=today.getSeconds();m=checkTime(m);s=checkTime(s);clock.innerHTML=`${h}:${m}`;const reloadTime=setTimeout(startTime,500)};function checkTime(i){if(i<10){i=`0${i}`};return i}})()